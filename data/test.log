/*C8*/SET SCHEMA PUBLIC
drop table if exists artists cascade 
drop table if exists billets cascade 
drop table if exists commandes cascade 
drop table if exists event_guests cascade 
drop table if exists events cascade 
drop table if exists organizers cascade 
drop table if exists type_billet cascade 
drop table if exists users cascade 
create table artists (id bigint generated by default as identity (start with 1), nomArtiste varchar(255) not null, photoUrl varchar(255), primary key (id))
create table billets (commande_id bigint not null, id bigint generated by default as identity (start with 1), type_billet_id bigint not null, code_barre varchar(255) not null unique, primary key (id))
create table commandes (montantTotal float(53), date timestamp(6), id bigint generated by default as identity (start with 1), user_id bigint not null, statut varchar(255) not null check (statut in ('ANNULE','REMBOURSE','VALIDEE')), primary key (id))
create table event_guests (id_artist bigint not null, id_event bigint not null)
create table events (date date, heure time(6), nbplaces integer, id bigint generated by default as identity (start with 1), id_organizer bigint not null, main_artist_id bigint not null, description varchar(2000), genreMusical varchar(255) not null check (genreMusical in ('POP','ROCK','SHATTA','JAZZ','HIP_HOP','ELECTRO','RAP')), lieu varchar(255), nom varchar(255) not null, primary key (id))
create table organizers (id bigint not null, nom_organisation varchar(255), primary key (id))
create table type_billet (prix float(53) not null, stock integer not null, event_id bigint not null, id bigint generated by default as identity (start with 1), type varchar(255) not null check (type in ('GrandPublic','VIP','EARLY_BIRD')), primary key (id))
create table users (id bigint generated by default as identity (start with 1), email varchar(255), mdp varchar(255), nom varchar(255), primary key (id))
alter table billets add constraint FKfowkx4rqpow7effcixe0uhv58 foreign key (commande_id) references commandes
alter table billets add constraint FKoyo73lfing4and7buowtiygxp foreign key (type_billet_id) references type_billet
alter table commandes add constraint FKavy0l3h0s3v20uoi8dfcq9ipc foreign key (user_id) references users
alter table event_guests add constraint FKmnr4sfahpiughiqb7ga7i2kli foreign key (id_artist) references artists
alter table event_guests add constraint FKphjw3hs11iyovyho5tg7coum9 foreign key (id_event) references events
alter table events add constraint FKer292l54tqjrd938l4gm4d2n foreign key (main_artist_id) references artists
alter table events add constraint FK8gx13k1k0jwvgi8q8jxjp8y5i foreign key (id_organizer) references organizers
alter table organizers add constraint FKknfg9jndm0r8mji804i38y1tb foreign key (id) references users
alter table type_billet add constraint FKqke1qu6tmwiq6xwma73lh047i foreign key (event_id) references events
DISCONNECT
/*C10*/SET SCHEMA PUBLIC
drop table if exists artists cascade 
drop table if exists billets cascade 
drop table if exists commandes cascade 
drop table if exists event_guests cascade 
drop table if exists events cascade 
drop table if exists organizers cascade 
drop table if exists type_billet cascade 
drop table if exists users cascade 
create table artists (id bigint generated by default as identity (start with 1), nomArtiste varchar(255) not null, photoUrl varchar(255), primary key (id))
create table billets (commande_id bigint not null, id bigint generated by default as identity (start with 1), type_billet_id bigint not null, code_barre varchar(255) not null unique, primary key (id))
create table commandes (montantTotal float(53), date timestamp(6), id bigint generated by default as identity (start with 1), user_id bigint not null, statut varchar(255) not null check (statut in ('ANNULE','REMBOURSE','VALIDEE')), primary key (id))
create table event_guests (id_artist bigint not null, id_event bigint not null)
create table events (date date, heure time(6), nbplaces integer, id bigint generated by default as identity (start with 1), id_organizer bigint not null, main_artist_id bigint not null, description varchar(2000), genreMusical varchar(255) not null check (genreMusical in ('POP','ROCK','SHATTA','JAZZ','HIP_HOP','ELECTRO','RAP')), lieu varchar(255), nom varchar(255) not null, primary key (id))
create table organizers (id bigint not null, nom_organisation varchar(255), primary key (id))
create table type_billet (prix float(53) not null, stock integer not null, event_id bigint not null, id bigint generated by default as identity (start with 1), type varchar(255) not null check (type in ('GrandPublic','VIP','EARLY_BIRD')), primary key (id))
create table users (id bigint generated by default as identity (start with 1), email varchar(255), mdp varchar(255), nom varchar(255), primary key (id))
alter table billets add constraint FKfowkx4rqpow7effcixe0uhv58 foreign key (commande_id) references commandes
alter table billets add constraint FKoyo73lfing4and7buowtiygxp foreign key (type_billet_id) references type_billet
alter table commandes add constraint FKavy0l3h0s3v20uoi8dfcq9ipc foreign key (user_id) references users
alter table event_guests add constraint FKmnr4sfahpiughiqb7ga7i2kli foreign key (id_artist) references artists
alter table event_guests add constraint FKphjw3hs11iyovyho5tg7coum9 foreign key (id_event) references events
alter table events add constraint FKer292l54tqjrd938l4gm4d2n foreign key (main_artist_id) references artists
alter table events add constraint FK8gx13k1k0jwvgi8q8jxjp8y5i foreign key (id_organizer) references organizers
alter table organizers add constraint FKknfg9jndm0r8mji804i38y1tb foreign key (id) references users
alter table type_billet add constraint FKqke1qu6tmwiq6xwma73lh047i foreign key (event_id) references events
DISCONNECT
/*C9*/SET SCHEMA PUBLIC
DISCONNECT
/*C11*/SET SCHEMA PUBLIC
DISCONNECT
/*C13*/SET SCHEMA PUBLIC
drop table if exists artists cascade 
drop table if exists billets cascade 
drop table if exists commandes cascade 
drop table if exists event_guests cascade 
drop table if exists events cascade 
drop table if exists organizers cascade 
drop table if exists type_billet cascade 
drop table if exists users cascade 
DISCONNECT
/*C12*/SET SCHEMA PUBLIC
DISCONNECT
/*C14*/SET SCHEMA PUBLIC
create table artists (id bigint generated by default as identity (start with 1), nomArtiste varchar(255) not null, photoUrl varchar(255), primary key (id))
create table billets (commande_id bigint not null, id bigint generated by default as identity (start with 1), type_billet_id bigint not null, code_barre varchar(255) not null unique, primary key (id))
create table commandes (montantTotal float(53), date timestamp(6), id bigint generated by default as identity (start with 1), user_id bigint not null, statut varchar(255) not null check (statut in ('ANNULE','REMBOURSE','VALIDEE')), primary key (id))
create table event_guests (id_artist bigint not null, id_event bigint not null)
create table events (date date, heure time(6), nbplaces integer, id bigint generated by default as identity (start with 1), id_organizer bigint not null, main_artist_id bigint not null, description varchar(2000), genreMusical varchar(255) not null check (genreMusical in ('POP','ROCK','SHATTA','JAZZ','HIP_HOP','ELECTRO','RAP')), lieu varchar(255), nom varchar(255) not null, primary key (id))
create table organizers (id bigint not null, nom_organisation varchar(255), primary key (id))
create table type_billet (prix float(53) not null, stock integer not null, event_id bigint not null, id bigint generated by default as identity (start with 1), type varchar(255) not null check (type in ('GrandPublic','VIP','EARLY_BIRD')), primary key (id))
create table users (id bigint generated by default as identity (start with 1), email varchar(255), mdp varchar(255), nom varchar(255), primary key (id))
alter table billets add constraint FKfowkx4rqpow7effcixe0uhv58 foreign key (commande_id) references commandes
alter table billets add constraint FKoyo73lfing4and7buowtiygxp foreign key (type_billet_id) references type_billet
alter table commandes add constraint FKavy0l3h0s3v20uoi8dfcq9ipc foreign key (user_id) references users
alter table event_guests add constraint FKmnr4sfahpiughiqb7ga7i2kli foreign key (id_artist) references artists
alter table event_guests add constraint FKphjw3hs11iyovyho5tg7coum9 foreign key (id_event) references events
alter table events add constraint FKer292l54tqjrd938l4gm4d2n foreign key (main_artist_id) references artists
alter table events add constraint FK8gx13k1k0jwvgi8q8jxjp8y5i foreign key (id_organizer) references organizers
alter table organizers add constraint FKknfg9jndm0r8mji804i38y1tb foreign key (id) references users
alter table type_billet add constraint FKqke1qu6tmwiq6xwma73lh047i foreign key (event_id) references events
DISCONNECT
/*C16*/SET SCHEMA PUBLIC
drop table if exists artists cascade 
drop table if exists billets cascade 
drop table if exists commandes cascade 
drop table if exists event_guests cascade 
drop table if exists events cascade 
drop table if exists organizers cascade 
drop table if exists type_billet cascade 
drop table if exists users cascade 
DISCONNECT
/*C15*/SET SCHEMA PUBLIC
DISCONNECT
/*C17*/SET SCHEMA PUBLIC
DROP TABLE EMPLOYEE 
DROP TABLE DEPARTMENT 
DROP TABLE HISTORIQUE_EVENT
DROP TABLE favoris
DROP TABLE organizer
DROP TABLE USER_ROLE
DROP TABLE ARTISTE_GENRE
DROP TABLE ARTISTE
DROP TABLE ROLE_ARTISTE
DROP TABLE GENRE_MUSICAL
DROP TABLE BILLETS_VENDUS
DROP TABLE EVENTS_CATEGORY
DROP TABLE PAIEMENT
DROP TABLE TYPE_TICKET
DISCONNECT
/*C18*/SET SCHEMA PUBLIC
create table artists (id bigint generated by default as identity (start with 1), nomArtiste varchar(255) not null, photoUrl varchar(255), primary key (id))
create table billets (commande_id bigint not null, id bigint generated by default as identity (start with 1), type_billet_id bigint not null, code_barre varchar(255) not null unique, primary key (id))
create table commandes (montantTotal float(53), date timestamp(6), id bigint generated by default as identity (start with 1), user_id bigint not null, statut varchar(255) not null check (statut in ('ANNULE','REMBOURSE','VALIDEE')), primary key (id))
create table event_guests (id_artist bigint not null, id_event bigint not null)
create table events (date date, heure time(6), nbplaces integer, id bigint generated by default as identity (start with 1), id_organizer bigint not null, main_artist_id bigint not null, description varchar(2000), genreMusical varchar(255) not null check (genreMusical in ('POP','ROCK','SHATTA','JAZZ','HIP_HOP','ELECTRO','RAP')), lieu varchar(255), nom varchar(255) not null, primary key (id))
create table organizers (id bigint not null, nom_organisation varchar(255), primary key (id))
create table type_billet (prix float(53) not null, stock integer not null, event_id bigint not null, id bigint generated by default as identity (start with 1), type varchar(255) not null check (type in ('GrandPublic','VIP','EARLY_BIRD')), primary key (id))
create table users (id bigint generated by default as identity (start with 1), email varchar(255), mdp varchar(255), nom varchar(255), primary key (id))
alter table billets add constraint FKfowkx4rqpow7effcixe0uhv58 foreign key (commande_id) references commandes
alter table billets add constraint FKoyo73lfing4and7buowtiygxp foreign key (type_billet_id) references type_billet
alter table commandes add constraint FKavy0l3h0s3v20uoi8dfcq9ipc foreign key (user_id) references users
alter table event_guests add constraint FKmnr4sfahpiughiqb7ga7i2kli foreign key (id_artist) references artists
alter table event_guests add constraint FKphjw3hs11iyovyho5tg7coum9 foreign key (id_event) references events
alter table events add constraint FKer292l54tqjrd938l4gm4d2n foreign key (main_artist_id) references artists
alter table events add constraint FK8gx13k1k0jwvgi8q8jxjp8y5i foreign key (id_organizer) references organizers
alter table organizers add constraint FKknfg9jndm0r8mji804i38y1tb foreign key (id) references users
alter table type_billet add constraint FKqke1qu6tmwiq6xwma73lh047i foreign key (event_id) references events
DISCONNECT
